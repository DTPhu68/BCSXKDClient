<div class="modal-header">
  <h5 class="modal-title"><i class="fas fa-key me-2"></i>Đổi mật khẩu</h5>
  <button type="button" class="btn-close" (click)="close()"></button>
</div>

<div class="modal-body">
  <form [formGroup]="form" (ngSubmit)="save()">
    <div class="mb-3">
      <label class="form-label">Mật khẩu hiện tại</label>
      <input type="password" class="form-control" formControlName="currentPassword" />
      <div class="text-danger small" *ngIf="f.currentPassword.touched && f.currentPassword.errors?.['required']">
        Bắt buộc
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Mật khẩu mới</label>
      <input type="password" class="form-control" formControlName="newPassword" />
      <div class="text-danger small" *ngIf="f.newPassword.touched">
        <span *ngIf="f.newPassword.errors?.['required']">Bắt buộc</span>
        <span *ngIf="f.newPassword.errors?.['minlength']">Tối thiểu 8 ký tự</span>
        <span *ngIf="f.newPassword.errors?.['weakPassword']">Phải có chữ hoa, chữ thường và số</span>
      </div>
      <div class="form-text">Gợi ý: tối thiểu 8 ký tự, gồm chữ hoa, chữ thường và số.</div>
    </div>

    <div class="mb-3">
      <label class="form-label">Xác nhận mật khẩu mới</label>
      <input type="password" class="form-control" formControlName="confirmPassword" />
      <div class="text-danger small" *ngIf="form.touched && form.errors?.['passwordMismatch']">
        Xác nhận mật khẩu không khớp
      </div>
    </div>

    <div class="d-flex justify-content-end gap-2">
      <button type="button" class="btn btn-secondary" (click)="close()" [disabled]="loading">Hủy</button>
      <button type="submit" class="btn btn-primary" [disabled]="loading">
        <span *ngIf="!loading">Đổi mật khẩu</span>
        <span *ngIf="loading" class="spinner-border spinner-border-sm"></span>
      </button>
    </div>
  </form>
</div>
